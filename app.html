<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TruckEase - Ride with Ease</title>
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Leaflet for map (free) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: #f4f7fc; padding-bottom: 70px; }

        /* Header */
        .header { background: white; padding: 15px; display: flex; align-items: center; gap: 10px; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .location-bar { background: #eef2ff; padding: 10px 15px; border-radius: 30px; flex: 1; font-size: 14px; color: #2854ff; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; cursor: pointer; }
        .lang-switch { background: #eef2ff; border: none; border-radius: 30px; padding: 8px 15px; font-weight: 600; cursor: pointer; font-size: 14px; color: #2854ff; }
        .user-icon { font-size: 24px; color: #2854ff; background: #eef2ff; width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* Tabs */
        .tabs { display: flex; gap: 10px; padding: 15px; overflow-x: auto; background: white; border-bottom: 1px solid #eee; }
        .tab { padding: 8px 20px; border-radius: 30px; background: #f0f0f0; font-weight: 600; font-size: 14px; white-space: nowrap; cursor: pointer; transition: 0.2s; }
        .tab.active { background: #2854ff; color: white; }

        /* Vehicle Cards */
        .section-title { padding: 15px 15px 5px; font-size: 18px; font-weight: 700; }
        .vehicle-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; padding: 0 15px 15px; }
        .vehicle-card { background: white; padding: 15px; border-radius: 16px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.02); border: 1px solid #eee; cursor: pointer; transition: 0.2s; }
        .vehicle-card:hover { border-color: #2854ff; box-shadow: 0 5px 15px rgba(40,84,255,0.1); }
        .vehicle-card .icon { font-size: 40px; margin-bottom: 5px; }
        .vehicle-card h4 { font-size: 14px; font-weight: 600; margin-bottom: 3px; }
        .vehicle-card p { font-size: 12px; color: #666; }

        /* Booking Screen */
        .screen { display: none; padding: 15px; }
        .screen.active { display: block; }
        .booking-header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .booking-header .back-btn { font-size: 24px; cursor: pointer; }
        .fare-box { background: #eef2ff; padding: 15px; border-radius: 16px; text-align: center; margin: 15px 0; }
        .fare-box .fare { font-size: 32px; font-weight: 800; color: #2854ff; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: 500; font-size: 14px; }
        .input-group input, .input-group textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 12px; font-size: 15px; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; font-weight: 600; font-size: 16px; cursor: pointer; margin-top: 10px; }
        .btn-primary { background: #2854ff; color: white; }
        .btn-secondary { background: #e0e0e0; color: #333; }

        /* Map */
        #map { height: 200px; border-radius: 16px; margin: 15px 0; display: none; }

        /* History List */
        .history-item { background: white; padding: 15px; border-radius: 16px; margin-bottom: 10px; border: 1px solid #eee; }
        .history-item .row { display: flex; justify-content: space-between; margin-bottom: 5px; }
        .status-badge { padding: 4px 10px; border-radius: 30px; font-size: 12px; font-weight: 600; }
        .status-completed { background: #d4edda; color: #155724; }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-accepted { background: #cce5ff; color: #004085; }

        /* Login Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; padding: 25px; border-radius: 30px; width: 90%; max-width: 350px; text-align: center; }
        .modal-content input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 12px; }
        #recaptcha-container { margin: 10px 0; }

        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; max-width: 450px; background: white; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #eee; left: 50%; transform: translateX(-50%); z-index: 100; }
        .nav-item { text-align: center; color: #999; font-size: 12px; cursor: pointer; }
        .nav-item.active { color: #2854ff; font-weight: 600; }
        .nav-item i { font-size: 20px; display: block; margin-bottom: 3px; }

        .loading { display: none; text-align: center; padding: 40px; }
        .loading.active { display: block; }
        .spinner { border: 3px solid #f3f3f3; border-top: 3px solid #2854ff; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<!-- Login Modal -->
<div id="loginModal" class="modal">
    <div class="modal-content">
        <h3 id="modalTitle">üì± Log in / Sign up</h3>
        <div id="phoneSection">
            <input type="tel" id="phoneNumber" placeholder="Mobile number (10 digits)" maxlength="10">
            <div id="recaptcha-container"></div>
            <button class="btn btn-primary" id="sendOtpBtn">Send OTP</button>
        </div>
        <div id="otpSection" style="display:none;">
            <input type="text" id="otpCode" placeholder="Enter OTP">
            <button class="btn btn-primary" id="verifyOtpBtn">Verify OTP</button>
        </div>
        <p id="loginError" style="color:red; font-size:12px;"></p>
    </div>
</div>

<!-- Header -->
<div class="header">
    <div class="location-bar" id="currentLocText" onclick="getCurrentLocation()">
        <i class="fas fa-map-marker-alt"></i> <span id="locationPlaceholder">Set location...</span>
    </div>
    <button class="lang-switch" id="langToggle" onclick="toggleLanguage()">üá∫üá∏ EN</button>
    <div class="user-icon" id="userIcon" onclick="showLoginModal()">
        <i class="fas fa-user"></i>
    </div>
</div>

<!-- Main content: different screens -->
<div id="homeScreen" class="screen active">
    <div class="tabs" id="tabContainer">
        <div class="tab active" data-category="trucks" id="tabTrucks">Trucks</div>
        <div class="tab" data-category="2wheeler" id="tab2Wheeler">2 Wheeler</div>
        <div class="tab" data-category="packers" id="tabPackers">Packers & Movers</div>
    </div>
    <h3 class="section-title" id="vehicleCategoryTitle">Mini Trucks</h3>
    <div class="vehicle-grid" id="vehicleGrid"></div>
</div>

<div id="bookingScreen" class="screen">
    <div class="booking-header">
        <i class="fas fa-arrow-left back-btn" onclick="goBack()"></i>
        <h3 id="bookingTitle">Booking Details</h3>
    </div>
    <div id="selectedVehicleInfo" style="margin-bottom:15px; font-weight:600;"></div>
    <div class="input-group">
        <label id="pickupLabel">Pickup location</label>
        <input type="text" id="pickupAddr" placeholder="Enter pickup address" value="Jalpura, Greater Noida">
    </div>
    <div class="input-group">
        <label id="dropLabel">Drop location</label>
        <input type="text" id="dropAddr" placeholder="Enter drop address">
    </div>
    <div class="input-group">
        <label id="distanceLabel">Distance (miles) - or use GPS</label>
        <input type="number" id="kmInput" placeholder="Distance in miles" oninput="calculateFare()">
    </div>
    <div id="map"></div>
    <button class="btn btn-secondary" onclick="getCurrentLocation()"><i class="fas fa-location-dot"></i> <span id="useLocationBtn">Use my location</span></button>
    <div class="fare-box">
        <span class="fare" id="fareAmount">$0</span>
        <div style="font-size:13px; color:#666;" id="estimatedFare">Estimated fare</div>
    </div>
    <button class="btn btn-primary" onclick="confirmBooking()" id="confirmBtn">Confirm Booking</button>
</div>

<div id="historyScreen" class="screen">
    <div class="booking-header">
        <i class="fas fa-arrow-left back-btn" onclick="goBack()"></i>
        <h3 id="historyTitle">Your Trips</h3>
    </div>
    <div id="historyList"></div>
</div>

<div id="trackingScreen" class="screen">
    <div class="booking-header">
        <i class="fas fa-arrow-left back-btn" onclick="goBack()"></i>
        <h3 id="trackingTitle">Tracking</h3>
    </div>
    <div id="trackingMap" style="height:300px; border-radius:16px; margin-bottom:15px;"></div>
    <div id="trackingDetails"></div>
    <button class="btn btn-secondary" onclick="cancelBooking()" id="cancelBtn">Cancel Trip</button>
</div>

<div id="successScreen" class="screen">
    <div style="text-align:center; padding:40px;">
        <i class="fas fa-check-circle" style="font-size:60px; color:#28a745;"></i>
        <h2 id="successTitle">Booking Confirmed!</h2>
        <div id="successDetails" style="background:#e8f5e9; padding:15px; border-radius:16px; margin:20px;"></div>
        <button class="btn btn-primary" onclick="goHome()" id="backHomeBtn">Back to Home</button>
    </div>
</div>

<!-- Bottom Navigation -->
<div class="bottom-nav">
    <div class="nav-item active" onclick="showScreen('homeScreen')"><i class="fas fa-home"></i><span id="navHome">Home</span></div>
    <div class="nav-item" onclick="showScreen('historyScreen')"><i class="fas fa-history"></i><span id="navTrips">Trips</span></div>
    <div class="nav-item" onclick="alert('Coming soon')"><i class="fas fa-wallet"></i><span id="navPayment">Payment</span></div>
    <div class="nav-item" onclick="alert('Coming soon')"><i class="fas fa-user"></i><span id="navProfile">Profile</span></div>
</div>

<!-- Loading spinner -->
<div id="loading" class="loading"><div class="spinner"></div><p id="loadingText">Loading...</p></div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
<!-- Leaflet -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    // ---------- FIREBASE CONFIG (same as your project) ----------
    const firebaseConfig = {
        apiKey: "AIzaSyByh4tT4zcUpjjQ_ebaYzpSulGtsDHjbw0",
        authDomain: "truckease-cb961.firebaseapp.com",
        projectId: "truckease-cb961",
        storageBucket: "truckease-cb961.firebasestorage.app",
        messagingSenderId: "558046020925",
        appId: "1:558046020925:web:573533af4bbf93841e3154"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // ---------- GLOBAL VARIABLES ----------
    let currentUser = null;
    let currentVehicle = null;
    let basePrice = 0, perKmRate = 0;
    let finalFare = 0;
    let map = null;
    let recaptchaVerifier;
    let currentLanguage = 'en'; // 'en' or 'hi'

    // ---------- LANGUAGE DICTIONARY ----------
    const translations = {
        en: {
            modalTitle: "üì± Log in / Sign up",
            phonePlaceholder: "Mobile number (10 digits)",
            sendOtp: "Send OTP",
            otpPlaceholder: "Enter OTP",
            verifyOtp: "Verify OTP",
            locationPlaceholder: "Set location...",
            tabTrucks: "Trucks",
            tab2Wheeler: "2 Wheeler",
            tabPackers: "Packers & Movers",
            vehicleCategoryTitle: "Mini Trucks",
            bookingTitle: "Booking Details",
            pickupLabel: "Pickup location",
            pickupPlaceholder: "Enter pickup address",
            dropLabel: "Drop location",
            dropPlaceholder: "Enter drop address",
            distanceLabel: "Distance (miles) - or use GPS",
            distancePlaceholder: "Distance in miles",
            useLocationBtn: "Use my location",
            estimatedFare: "Estimated fare",
            confirmBtn: "Confirm Booking",
            historyTitle: "Your Trips",
            trackingTitle: "Tracking",
            cancelBtn: "Cancel Trip",
            successTitle: "Booking Confirmed!",
            backHomeBtn: "Back to Home",
            navHome: "Home",
            navTrips: "Trips",
            navPayment: "Payment",
            navProfile: "Profile",
            loadingText: "Loading...",
            currencySymbol: "$",
            unit: "mi",
        },
        hi: {
            modalTitle: "üì± ‡§≤‡•â‡§ó‡§ø‡§® / ‡§∏‡§æ‡§á‡§® ‡§Ö‡§™",
            phonePlaceholder: "‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (10 ‡§Ö‡§Ç‡§ï)",
            sendOtp: "OTP ‡§≠‡•á‡§ú‡•á‡§Ç",
            otpPlaceholder: "OTP ‡§°‡§æ‡§≤‡•á‡§Ç",
            verifyOtp: "OTP ‡§µ‡•á‡§∞‡§ø‡§´‡§æ‡§à ‡§ï‡§∞‡•á‡§Ç",
            locationPlaceholder: "‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç...",
            tabTrucks: "‡§ü‡•ç‡§∞‡§ï",
            tab2Wheeler: "‡§¶‡•ã ‡§™‡§π‡§ø‡§Ø‡§æ",
            tabPackers: "‡§™‡•à‡§ï‡§∞‡•ç‡§∏ ‡§è‡§Ç‡§° ‡§Æ‡•Ç‡§µ‡§∞‡•ç‡§∏",
            vehicleCategoryTitle: "‡§õ‡•ã‡§ü‡•á ‡§ü‡•ç‡§∞‡§ï",
            bookingTitle: "‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§°‡§ø‡§ü‡•á‡§≤‡•ç‡§∏",
            pickupLabel: "‡§™‡§ø‡§ï‡§Ö‡§™ ‡§≤‡•ã‡§ï‡•á‡§∂‡§®",
            pickupPlaceholder: "‡§™‡§ø‡§ï‡§Ö‡§™ ‡§™‡§§‡§æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç",
            dropLabel: "‡§°‡•ç‡§∞‡•â‡§™ ‡§≤‡•ã‡§ï‡•á‡§∂‡§®",
            dropPlaceholder: "‡§°‡•ç‡§∞‡•â‡§™ ‡§™‡§§‡§æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç",
            distanceLabel: "‡§¶‡•Ç‡§∞‡•Ä (‡§ï‡§ø‡§Æ‡•Ä) - ‡§Ø‡§æ GPS ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç",
            distancePlaceholder: "‡§ï‡§ø‡§≤‡•ã‡§Æ‡•Ä‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§¶‡•Ç‡§∞‡•Ä",
            useLocationBtn: "‡§Æ‡•á‡§∞‡•Ä ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç",
            estimatedFare: "‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ",
            confirmBtn: "‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§®‡•ç‡§´‡§∞‡•ç‡§Æ ‡§ï‡§∞‡•á‡§Ç",
            historyTitle: "‡§Ü‡§™‡§ï‡•Ä ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ‡§è‡§Å",
            trackingTitle: "‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó",
            cancelBtn: "‡§ü‡•ç‡§∞‡§ø‡§™ ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",
            successTitle: "‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡§´‡§≤!",
            backHomeBtn: "‡§π‡•ã‡§Æ ‡§ú‡§æ‡§è‡§Å",
            navHome: "‡§π‡•ã‡§Æ",
            navTrips: "‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ‡§è‡§Å",
            navPayment: "‡§≠‡•Å‡§ó‡§§‡§æ‡§®",
            navProfile: "‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤",
            loadingText: "‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
            currencySymbol: "‚Çπ",
            unit: "‡§ï‡§ø‡§Æ‡•Ä",
        }
    };

    // ---------- VEHICLE DATA (prices stored in USD/INR numerically same, but symbol changes) ----------
    const vehicleData = {
        trucks: [
            { icon: 'üõª', nameEn: 'Tata Ace', nameHi: '‡§ü‡§æ‡§ü‡§æ ‡§ê‡§∏', descEn: '$5 base (10mi), then $0.5/mi', descHi: '‚Çπ5 ‡§¨‡•á‡§∏ (10‡§ï‡§ø‡§Æ‡•Ä), ‡§´‡§ø‡§∞ ‚Çπ0.5/‡§ï‡§ø‡§Æ‡•Ä', base: 5, perKm: 0.5 },
            { icon: 'üöö', nameEn: 'Pickup 8ft', nameHi: '‡§™‡§ø‡§ï‡§Ö‡§™ 8‡§´‡•Ä‡§ü', descEn: '$12 base + $0.4/mi', descHi: '‚Çπ12 ‡§¨‡•á‡§∏ + ‚Çπ0.4/‡§ï‡§ø‡§Æ‡•Ä', base: 12, perKm: 0.4 },
            { icon: 'üöõ', nameEn: '14ft Truck', nameHi: '14‡§´‡•Ä‡§ü ‡§ü‡•ç‡§∞‡§ï', descEn: '$25 base + $0.4/mi', descHi: '‚Çπ25 ‡§¨‡•á‡§∏ + ‚Çπ0.4/‡§ï‡§ø‡§Æ‡•Ä', base: 25, perKm: 0.4 },
            { icon: 'üü®üöú', nameEn: 'JCB', nameHi: '‡§ú‡•á‡§∏‡•Ä‡§¨‡•Ä', descEn: '$30 base + $0.6/mi', descHi: '‚Çπ30 ‡§¨‡•á‡§∏ + ‚Çπ0.6/‡§ï‡§ø‡§Æ‡•Ä', base: 30, perKm: 0.6 },
            { icon: 'üèóÔ∏è', nameEn: 'Crane', nameHi: '‡§ï‡•ç‡§∞‡•á‡§®', descEn: '$40 base + $0.8/mi', descHi: '‚Çπ40 ‡§¨‡•á‡§∏ + ‚Çπ0.8/‡§ï‡§ø‡§Æ‡•Ä', base: 40, perKm: 0.8 },
            { icon: 'üöú', nameEn: 'Tractor', nameHi: '‡§ü‡•ç‡§∞‡•à‡§ï‡•ç‡§ü‡§∞', descEn: '$18 base + $0.35/mi', descHi: '‚Çπ18 ‡§¨‡•á‡§∏ + ‚Çπ0.35/‡§ï‡§ø‡§Æ‡•Ä', base: 18, perKm: 0.35 }
        ],
        '2wheeler': [
            { icon: 'üõµ', nameEn: 'Bike', nameHi: '‡§¨‡§æ‡§á‡§ï', descEn: '$0.5 base + $0.1/mi', descHi: '‚Çπ0.5 ‡§¨‡•á‡§∏ + ‚Çπ0.1/‡§ï‡§ø‡§Æ‡•Ä', base: 0.5, perKm: 0.1 },
            { icon: 'üõ¥', nameEn: 'Scooty', nameHi: '‡§∏‡•ç‡§ï‡•Ç‡§ü‡•Ä', descEn: '$0.4 base + $0.08/mi', descHi: '‚Çπ0.4 ‡§¨‡•á‡§∏ + ‚Çπ0.08/‡§ï‡§ø‡§Æ‡•Ä', base: 0.4, perKm: 0.08 }
        ],
        packers: [
            { icon: 'üöö', nameEn: 'Mini Truck + Labour', nameHi: '‡§Æ‡§ø‡§®‡•Ä ‡§ü‡•ç‡§∞‡§ï + ‡§≤‡•á‡§¨‡§∞', descEn: '$15 base + $0.3/mi', descHi: '‚Çπ15 ‡§¨‡•á‡§∏ + ‚Çπ0.3/‡§ï‡§ø‡§Æ‡•Ä', base: 15, perKm: 0.3 },
            { icon: 'üè†', nameEn: 'House Shifting', nameHi: '‡§π‡§æ‡§â‡§∏ ‡§∂‡§ø‡§´‡•ç‡§ü‡§ø‡§Ç‡§ó', descEn: '$30 base + $0.4/mi', descHi: '‚Çπ30 ‡§¨‡•á‡§∏ + ‚Çπ0.4/‡§ï‡§ø‡§Æ‡•Ä', base: 30, perKm: 0.4 }
        ]
    };

    // ---------- LANGUAGE TOGGLE ----------
    window.toggleLanguage = function() {
        currentLanguage = currentLanguage === 'en' ? 'hi' : 'en';
        document.getElementById('langToggle').innerText = currentLanguage === 'en' ? 'üá∫üá∏ EN' : 'üáÆüá≥ HI';
        updateUILanguage();
        // Reload vehicle grid to update descriptions
        const activeTab = document.querySelector('.tab.active').dataset.category;
        loadVehicleGrid(activeTab);
    };

    function updateUILanguage() {
        const t = translations[currentLanguage];
        document.getElementById('modalTitle').innerText = t.modalTitle;
        document.getElementById('phoneNumber').placeholder = t.phonePlaceholder;
        document.getElementById('sendOtpBtn').innerText = t.sendOtp;
        document.getElementById('otpCode').placeholder = t.otpPlaceholder;
        document.getElementById('verifyOtpBtn').innerText = t.verifyOtp;
        document.getElementById('locationPlaceholder').innerText = t.locationPlaceholder;
        document.getElementById('tabTrucks').innerText = t.tabTrucks;
        document.getElementById('tab2Wheeler').innerText = t.tab2Wheeler;
        document.getElementById('tabPackers').innerText = t.tabPackers;
        document.getElementById('vehicleCategoryTitle').innerText = t.vehicleCategoryTitle;
        document.getElementById('bookingTitle').innerText = t.bookingTitle;
        document.getElementById('pickupLabel').innerText = t.pickupLabel;
        document.getElementById('pickupAddr').placeholder = t.pickupPlaceholder;
        document.getElementById('dropLabel').innerText = t.dropLabel;
        document.getElementById('dropAddr').placeholder = t.dropPlaceholder;
        document.getElementById('distanceLabel').innerText = t.distanceLabel;
        document.getElementById('kmInput').placeholder = t.distancePlaceholder;
        document.getElementById('useLocationBtn').innerText = t.useLocationBtn;
        document.getElementById('estimatedFare').innerText = t.estimatedFare;
        document.getElementById('confirmBtn').innerText = t.confirmBtn;
        document.getElementById('historyTitle').innerText = t.historyTitle;
        document.getElementById('trackingTitle').innerText = t.trackingTitle;
        document.getElementById('cancelBtn').innerText = t.cancelBtn;
        document.getElementById('successTitle').innerText = t.successTitle;
        document.getElementById('backHomeBtn').innerText = t.backHomeBtn;
        document.getElementById('navHome').innerText = t.navHome;
        document.getElementById('navTrips').innerText = t.navTrips;
        document.getElementById('navPayment').innerText = t.navPayment;
        document.getElementById('navProfile').innerText = t.navProfile;
        document.getElementById('loadingText').innerText = t.loadingText;
        // Update fare display if visible
        calculateFare();
    }

    // ---------- AUTH STATE ----------
    auth.onAuthStateChanged(user => {
        if (user) {
            currentUser = user;
            document.getElementById('userIcon').innerHTML = `<i class="fas fa-user-check"></i>`;
        } else {
            currentUser = null;
            document.getElementById('userIcon').innerHTML = `<i class="fas fa-user"></i>`;
        }
    });

    // ---------- LOGIN MODAL ----------
    window.showLoginModal = function() {
        if (currentUser) {
            auth.signOut();
    <script>
    // ... (‡§Ü‡§™‡§ï‡§æ ‡§™‡•Å‡§∞‡§æ‡§®‡§æ config ‡§î‡§∞ variables ‡§Ø‡§π‡§æ‡§Å ‡§∞‡§π‡•á‡§Ç‡§ó‡•á)

    // ‡§∏‡•Å‡§ß‡§æ‡§∞: ‡§™‡•á‡§ú ‡§≤‡•ã‡§° ‡§π‡•ã‡§§‡•á ‡§π‡•Ä ‡§ó‡§æ‡§°‡§º‡§ø‡§Ø‡§æ‡§Å ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§≠‡§æ‡§∑‡§æ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
    window.onload = function() {
        updateUILanguage(); // ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§≠‡§æ‡§∑‡§æ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
        loadVehicleGrid('trucks'); // ‡§ó‡§æ‡§°‡§º‡§ø‡§Ø‡§æ‡§Å ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç
    };

    function loadVehicleGrid(category) {
        const grid = document.getElementById('vehicleGrid');
        const t = translations[currentLanguage];
        let html = '';
        
        vehicleData[category].forEach(v => {
            const name = currentLanguage === 'en' ? v.nameEn : v.nameHi;
            const desc = currentLanguage === 'en' ? v.descEn : v.descHi;
            
            html += `<div class="vehicle-card" onclick="selectVehicle('${name}', ${v.base}, ${v.perKm})">
                <div class="icon">${v.icon}</div>
                <h4>${name}</h4>
                <p>${desc}</p>
            </div>`;
        });
        grid.innerHTML = html;
        
        // ‡§ü‡•à‡§¨ ‡§ï‡•ã ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø (Active) ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
            if(tab.dataset.category === category) tab.classList.add('active');
        });
    }

    // ‡§ó‡§æ‡•ú‡•Ä ‡§ö‡•Å‡§®‡§®‡•á ‡§™‡§∞ ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§ñ‡•ã‡§≤‡•á‡§Ç
    window.selectVehicle = function(name, base, rate) {
        currentVehicle = name;
        basePrice = base;
        perKmRate = rate;
        document.getElementById('selectedVehicleInfo').innerHTML = `<strong>${translations[currentLanguage].navProfile}:</strong> ${name}`;
        showScreen('bookingScreen');
    };

    // ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§ó‡§ø‡§®‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
    window.calculateFare = function() {
        let km = parseFloat(document.getElementById('kmInput').value) || 0;
        let fare = basePrice + (km * perKmRate);
        const symbol = translations[currentLanguage].currencySymbol;
        document.getElementById('fareAmount').innerText = symbol + fare.toFixed(2);
    };

    // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
    window.showScreen = function(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    };

    function goBack() { showScreen('homeScreen'); }
    function goHome() { showScreen('homeScreen'); }

    // ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§®‡•ç‡§´‡§∞‡•ç‡§Æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§´‡§æ‡§Ø‡§∞‡§¨‡•á‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
    window.confirmBooking = async function() {
        if (!auth.currentUser) { alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç!"); showLoginModal(); return; }
        
        const booking = {
            vehicle: currentVehicle,
            pickup: document.getElementById('pickupAddr').value,
            drop: document.getElementById('dropAddr').value,
            fare: document.getElementById('fareAmount').innerText,
            status: 'pending',
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };

        try {
            await db.collection('bookings').add(booking);
            showScreen('successScreen');
        } catch (e) {
            alert("Error: " + e.message);
        }
    };
</script>
</body>
</html>
