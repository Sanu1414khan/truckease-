<div id="ownerPanel" class="admin-screen">
    <aside class="sidebar">
        <div class="brand">
            <i class="fas fa-shield-alt"></i> TruckEase <span>PRO</span>
        </div>
        <nav>
            <div class="nav-link active" onclick="switchTab('overview')"><i class="fas fa-chart-pie"></i> Fleet Overview</div>
            <div class="nav-link" onclick="switchTab('live-map')"><i class="fas fa-map-marked-alt"></i> Live GPS Tracking</div>
            <div class="nav-link" onclick="switchTab('dispatch')"><i class="fas fa-shipping-fast"></i> Dispatch Board</div>
            <div class="nav-link" onclick="switchTab('drivers')"><i class="fas fa-users"></i> Driver Compliance</div>
            <div class="nav-link" onclick="switchTab('financials')"><i class="fas fa-file-invoice-dollar"></i> Revenue & Payouts</div>
            <div class="nav-link" onclick="switchTab('settings')"><i class="fas fa-cog"></i> System Settings</div>
        </nav>
    </aside>

    <main class="main-content">
        <header class="top-bar">
            <div class="search-box"><i class="fas fa-search"></i> <input type="text" placeholder="Search Load ID, Driver, or VIN..."></div>
            <div class="admin-profile">
                <i class="fas fa-bell"></i>
                <div class="avatar">HQ</div>
            </div>
        </header>

        <div id="dashboard-view" class="view-content active">
            <div class="stats-row">
                <div class="stat-card primary">
                    <div class="label">Gross Revenue (MTD)</div>
                    <div class="value" id="grossRevenue">$0.00</div>
                    <div class="trend up"><i class="fas fa-arrow-up"></i> 12% vs last month</div>
                </div>
                <div class="stat-card">
                    <div class="label">Active Loads</div>
                    <div class="value" id="activeLoadsCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="label">Idle Drivers</div>
                    <div class="value" id="idleDrivers">0</div>
                </div>
                <div class="stat-card danger">
                    <div class="label">Compliance Alerts</div>
                    <div class="value">3</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="card header-card">
                    <h3>Revenue Growth (USD)</h3>
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
        </div>
    </main>
</div>
<style>
    :root { --primary: #2854ff; --dark: #0f172a; --bg: #f8fafc; --text: #334155; }
    .admin-screen { display: flex; min-height: 100vh; background: var(--bg); }
    
    /* Sidebar styling */
    .sidebar { width: 260px; background: var(--dark); color: white; padding: 20px; }
    .brand { font-size: 22px; font-weight: 800; margin-bottom: 40px; color: var(--primary); }
    .brand span { color: white; font-weight: 300; }
    .nav-link { padding: 15px; border-radius: 12px; cursor: pointer; margin-bottom: 5px; transition: 0.3s; color: #94a3b8; }
    .nav-link:hover, .nav-link.active { background: var(--primary); color: white; }
    .nav-link i { margin-right: 12px; }

    /* Main Content */
    .main-content { flex: 1; padding: 30px; }
    .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
    .search-box { background: white; padding: 10px 20px; border-radius: 30px; width: 400px; display: flex; align-items: center; border: 1px solid #e2e8f0; }
    .search-box input { border: none; outline: none; margin-left: 10px; width: 100%; }

    /* Stats Cards */
    .stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
    .stat-card { background: white; padding: 25px; border-radius: 20px; border: 1px solid #e2e8f0; position: relative; }
    .stat-card.primary { border-left: 5px solid var(--primary); }
    .stat-card.danger { border-left: 5px solid #ef4444; }
    .stat-card .label { color: #64748b; font-size: 14px; font-weight: 600; }
    .stat-card .value { font-size: 28px; font-weight: 800; color: var(--dark); margin-top: 5px; }
    .trend { font-size: 12px; margin-top: 10px; font-weight: 700; }
    .trend.up { color: #10b981; }

    .chart-container { background: white; padding: 25px; border-radius: 24px; border: 1px solid #e2e8f0; }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    async function initOwnerDashboard() {
        // 1. Fetch Stats from Firebase
        const bookingsSnap = await db.collection('bookings').get();
        let totalRev = 0;
        let activeLoads = 0;

        bookingsSnap.forEach(doc => {
            const data = doc.data();
            totalRev += (data.fare || 0);
            if(data.status === 'accepted' || data.status === 'pending') activeLoads++;
        });

        document.getElementById('grossRevenue').innerText = '$' + totalRev.toLocaleString('en-US', {minimumFractionDigits: 2});
        document.getElementById('activeLoadsCount').innerText = activeLoads;

        // 2. Load Chart
        const ctx = document.getElementById('revenueChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [{
                    label: 'Revenue',
                    data: [12000, 19000, 15000, totalRev > 0 ? totalRev : 25000],
                    borderColor: '#2854ff',
                    fill: true,
                    backgroundColor: 'rgba(40,84,255,0.05)',
                    tension: 0.4
                }]
            }
        });
    }

    // Initialize on load
    window.addEventListener('load', initOwnerDashboard);
</script>
</body>
</html>
