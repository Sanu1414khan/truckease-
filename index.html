3<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>TruckEase ‚Ä¢ ‡§∏‡•Å‡§™‡§∞ ‡§∏‡§ø‡§Ç‡§™‡§≤</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background: #e9ecef;
            padding: 16px;
            display: flex;
            justify-content: center;
        }
        .app {
            max-width: 450px;
            width: 100%;
            background: white;
            border-radius: 32px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            padding: 22px 20px;
        }
        h1, h2, h3 { color: #0b3b5c; margin-bottom: 16px; }
        .truck-btn, .screen-btn, .action-btn {
            background: #1a73e8;
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 40px;
            font-size: 18px;
            font-weight: 600;
            width: 100%;
            margin: 10px 0;
            cursor: pointer;
            transition: 0.2s;
        }
        .truck-btn { background: #0d47a1; }
        .screen-btn { background: #34a853; }
        .action-btn { background: #f9a825; color: black; }
        input, select {
            width: 100%;
            padding: 14px 18px;
            margin: 8px 0 18px;
            border: 2px solid #dadce0;
            border-radius: 30px;
            font-size: 16px;
        }
        .card {
            background: #f1f3f4;
            border-radius: 24px;
            padding: 18px;
            margin: 16px 0;
            border-left: 8px solid #1a73e8;
        }
        .fare-box {
            background: #e6f4ea;
            padding: 18px;
            border-radius: 20px;
            font-size: 22px;
            font-weight: bold;
            color: #0d652d;
            margin: 15px 0;
        }
        .commission {
            background: #fef7e0;
            padding: 12px;
            border-radius: 16px;
            margin-top: 5px;
            font-weight: 600;
        }
        .hidden { display: none; }
        .history-item {
            background: white;
            border-radius: 16px;
            padding: 14px;
            margin-bottom: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            border: 1px solid #e0e0e0;
        }
    </style>
</head>
<body>
<div class="app" id="app">

    <!-- ‡§π‡•á‡§°‡§∞ -->
    <div style="display:flex; justify-content: space-between; align-items:center; margin-bottom:20px;">
        <h1 style="font-size:28px; margin:0;">üöõ TruckEase</h1>
        <span style="background:#0b3b5c; color:white; padding:6px 14px; border-radius:30px;">‡§¨‡§ø‡§®‡§æ OTP</span>
    </div>

    <!-- ========== ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® : ‡§≤‡•â‡§ó‡§ø‡§® (‡§∏‡§ø‡§∞‡•ç‡§´ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•ã) ========= -->
    <div id="loginScreen">
        <h2>üì± ‡§Ö‡§™‡§®‡§æ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•ã</h2>
        <input type="tel" id="mobileInput" placeholder="‡§â‡§¶‡§æ: 9876543210" maxlength="10">
        <button id="login-btn" class="screen-btn" onclick="sendOTP()">‚úÖ OTP ‡§≠‡•á‡§ú‡•á‡§Ç</button>
<div id="recaptcha-container"></div>
<p style="margin-top:16px; color:gray; font-size:14px;">‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•á ‡§®‡§Ç‡§¨‡§∞ ‡§™‡§∞ OTP ‡§Ü‡§è‡§ó‡§æ‡•§</p>
        
        <p style="margin-top:16px; color:gray; font-size:14px;">‡§ï‡•ã‡§à OTP ‡§®‡§π‡•Ä‡§Ç, ‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•ã ‡§î‡§∞ ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡•ã‡•§</p>
    </div>

    <!-- ========== ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® : ‡§π‡•ã‡§Æ (‡§Ø‡•Ç‡§ú‡§∞ ‡§ü‡§æ‡§á‡§™) ========= -->
    <div id="homeScreen" class="hidden">
        <h2>üëã ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à, <span id="userPhoneDisplay"></span></h2>
        <button class="truck-btn" onclick="showCustomerPanel()">üôã‚Äç‚ôÇÔ∏è ‡§Æ‡•à‡§Ç ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§π‡•Ç‡§Å ‚Äì ‡§ó‡§æ‡§°‡§º‡•Ä ‡§¨‡•Å‡§ï ‡§ï‡§∞‡•Ç‡§Å</button>
        <button class="truck-btn" style="background:#34a853;" onclick="showDriverReg()">üöõ ‡§Æ‡•à‡§Ç ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§π‡•Ç‡§Å ‚Äì ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•Ç‡§Å</button>
        <button class="action-btn" onclick="showHistory()">üìú ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
    </div>

    <!-- ========== ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® : ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ========= -->
    <div id="driverRegScreen" class="hidden">
    <button class="action-btn" style="background:#e0e0e0; color:black;" onclick="backToHome()">‚Üê ‡§µ‡§æ‡§™‡§∏</button>
    <h2>üöõ ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§®</h2>
    <input type="text" id="driverName" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ">
    <input type="text" id="driverVehicle" placeholder="‡§ó‡§æ‡§°‡§º‡•Ä ‡§ï‡§æ ‡§®‡§Ç‡§¨‡§∞">
    <select id="driverTruckType">
        <option value="‡§õ‡•ã‡§ü‡§æ ‡§π‡§æ‡§•‡•Ä">‡§õ‡•ã‡§ü‡§æ ‡§π‡§æ‡§•‡•Ä (‡§õ‡•ã‡§ü‡•Ä ‡§ó‡§æ‡§°‡§º‡•Ä)</option>
        <option value="‡§Æ‡§ù‡•ã‡§≤‡§æ ‡§ü‡•ç‡§∞‡§ï (‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§Æ)">‡§Æ‡§ù‡•ã‡§≤‡§æ ‡§ü‡•ç‡§∞‡§ï (‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§Æ)</option>
        <option value="‡§≠‡§æ‡§∞‡•Ä ‡§ü‡•ç‡§∞‡§ï (‡§¨‡§°‡§º‡§æ)">‡§≠‡§æ‡§∞‡•Ä ‡§ü‡•ç‡§∞‡§ï (‡§¨‡§°‡§º‡§æ)</option>
    </select>
    <input type="number" id="driverLabour" placeholder="‡§ï‡§ø‡§§‡§®‡•á ‡§Æ‡§ú‡§¶‡•Ç‡§∞? (0-5)">

    <input type="tel" id="driverMobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (10 ‡§Ö‡§Ç‡§ï)" maxlength="10">
    <input type="text" id="driverAadhaar" placeholder="‡§Ü‡§ß‡§æ‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§®‡§Ç‡§¨‡§∞ (12 ‡§Ö‡§Ç‡§ï)" maxlength="12">
    <input type="text" id="driverLicense" placeholder="‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§ø‡§Ç‡§ó ‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§®‡§Ç‡§¨‡§∞">
    
    <button class="screen-btn" onclick="registerDriver()">‚úÖ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
    </div>
    

    <!-- ========== ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® : ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§™‡•à‡§®‡§≤ ‚Äì ‡§ó‡§æ‡§°‡§º‡•Ä ‡§ö‡•Å‡§®‡•ã ========= -->
<div id="customerPanel" class="hidden">
    <button class="action-btn" style="background:#e0e0e0;" onclick="backToHome()">‚Üê ‡§µ‡§æ‡§™‡§∏</button>
    <h2>üöõ ‡§ó‡§æ‡§°‡§º‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç</h2>
    
    <!-- ‡§™‡§π‡§≤‡§æ ‡§ï‡§æ‡§∞‡•ç‡§° - ‡§õ‡•ã‡§ü‡§æ ‡§π‡§æ‡§•‡•Ä ‚Üí Total chhote truck -->
    <div class="card" onclick="selectTruck('Total chhote truck', 0)">
        <b style="font-size:18px;">üõª Total chhote truck</b><br>
        <span>‡§õ‡•ã‡§ü‡•Ä ‡§ó‡§æ‡§°‡§º‡•Ä - ‚Çπ500 (10km), ‚Çπ1000 (20km), ‡§´‡§ø‡§∞ ‚Çπ50/km</span>
    </div>
    
    <!-- ‡§¶‡•Ç‡§∏‡§∞‡§æ ‡§ï‡§æ‡§∞‡•ç‡§° - ‡§Æ‡§ù‡•ã‡§≤‡§æ ‡§ü‡•ç‡§∞‡§ï ‚Üí Total medium truck -->
    <div class="card" onclick="selectTruck('Total medium truck', 1200)">
        <b style="font-size:18px;">üöö Total medium truck</b><br>
        <span>‡§Æ‡§ù‡•ã‡§≤‡•Ä ‡§ó‡§æ‡§°‡§º‡•Ä - ‚Çπ1200 ‡§¨‡•á‡§∏ + ‚Çπ40/km</span>
    </div>
    
    <!-- ‡§§‡•Ä‡§∏‡§∞‡§æ ‡§ï‡§æ‡§∞‡•ç‡§° - ‡§≠‡§æ‡§∞‡•Ä ‡§ü‡•ç‡§∞‡§ï ‚Üí Total Bhari aur badhiya truck -->
    <div class="card" onclick="selectTruck('Total Bhari aur bade truck', 2500)">
        <b style="font-size:18px;">üöõ Total Bhari aur badhiya truck</b><br>
        <span>‡§≠‡§æ‡§∞‡•Ä ‡§ó‡§æ‡§°‡§º‡•Ä - ‚Çπ2500 ‡§¨‡•á‡§∏ + ‚Çπ40/km</span>
    </div>
    
    <!-- ‡§ö‡•å‡§•‡§æ ‡§ï‡§æ‡§∞‡•ç‡§° - JCB & Bulldozer -->
<div class="card" onclick="selectTruck('Total JCB and bulldozer', 3000)">
    <b style="font-size:18px;">üèóÔ∏è Total JCB and bulldozer</b><br>
    <span>JCB & ‡§¨‡•Å‡§≤‡§°‡•ã‡§ú‡§º‡§∞ - ‚Çπ3000 ‡§¨‡•á‡§∏ + ‚Çπ60/km</span>
</div<!-- ‡§™‡§æ‡§Å‡§ö‡§µ‡§æ‡§Å ‡§ï‡§æ‡§∞‡•ç‡§° - Crane -->
<div> 
    
</div <!-- ‡§™‡§æ‡§Å‡§ö‡§µ‡§æ‡§Å ‡§ï‡§æ‡§∞‡•ç‡§° - Crane -->
<div class="card" onclick="selectTruck('Total chhoti aur Badi crane', 4000)">
    <b style="font-size:18px;">üèóÔ∏è Total chhoti aur Badi crane</b><br>
    <span>‡§ï‡•ç‡§∞‡•á‡§® - ‚Çπ4000 ‡§¨‡•á‡§∏ + ‚Çπ80/km</span>
</div>
    
</div>
    </div>

    <!-- ========== ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® : ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§°‡§ø‡§ü‡•á‡§≤ ========= -->
    <div id="bookingScreen" class="hidden">
        <button class="action-btn" style="background:#e0e0e0;" onclick="backToCustomerPanel()">‚Üê ‡§µ‡§æ‡§™‡§∏</button>
        <h3>üìã ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó</h3>
        <div id="selectedTruckDisplay" style="background:#bbdefb; padding:12px; border-radius:20px; margin-bottom:12px; font-weight:bold;"></div>
        <div id="labourDisplay" style="background:#fff3cd; padding:12px; border-radius:16px; margin-bottom:12px;">üë∑ ‡§Æ‡§ú‡§¶‡•Ç‡§∞: 2</div>
        <input type="number" id="kmInput" placeholder="‡§ï‡§ø‡§§‡§®‡•á ‡§ï‡§ø‡§≤‡•ã‡§Æ‡•Ä‡§ü‡§∞?" oninput="calculateFare()">
        <div class="fare-box" id="fareDisplay">‡§ï‡•Å‡§≤ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ: ‚Çπ0</div>
        <div class="commission" id="commissionDisplay">üü¢ 15% ‡§ê‡§™ ‡§ï‡§Æ‡•Ä‡§∂‡§®: ‚Çπ0</div>
        <button class="screen-btn" onclick="confirmBooking()">‚úÖ ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§®‡•ç‡§´‡§∞‡•ç‡§Æ ‡§ï‡§∞‡•á‡§Ç</button>
    </div>

    <!-- ========== ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® : ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡§ï‡•ç‡§∏‡•á‡§∏ ========= -->
    <div id="successScreen" class="hidden">
        <div style="text-align:center;">
            <span style="font-size:64px;">‚úÖ</span>
            <h2>‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡§´‡§≤!</h2>
            <div id="billDetails" class="card" style="background:#e8f5e9;"></div>
            <button class="truck-btn" onclick="backToHome()">üè† ‡§π‡•ã‡§Æ ‡§ú‡§æ‡§è‡§Å</button>
        </div>
    </div>

    <!-- ========== ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® : ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ========= -->
    <div id="historyScreen" class="hidden">
        <button class="action-btn" style="background:#e0e0e0;" onclick="backToHome()">‚Üê ‡§µ‡§æ‡§™‡§∏</button>
        <h2>üìú ‡§Ü‡§™‡§ï‡•Ä ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó</h2>
        <div id="historyList"></div>
    </div>

</div>

<script>
    // ---------- ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§µ‡•á‡§∞‡§ø‡§è‡§¨‡§≤ ----------
    let currentUser = localStorage.getItem('truckUser') || '';
    let selectedTruck = '';
    let basePrice = 0;
    let finalFare = 0;
    let commission = 0;
    let labourCount = 2;   // ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§Æ‡§ú‡§¶‡•Ç‡§∞
    let drivers = [];      // ‡§´‡§ø‡§≤‡§π‡§æ‡§≤ ‡§≤‡•ã‡§ï‡§≤ ‡§Æ‡•á‡§Ç ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§∏‡•á‡§µ ‡§π‡•ã‡§Ç‡§ó‡•á

    // ---------- ‡§™‡•á‡§ú ‡§≤‡•ã‡§° ‡§π‡•ã‡§§‡•á ‡§π‡•Ä ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ----------
    window.onload = function() {
        if (currentUser) {
            document.getElementById('userPhoneDisplay').innerText = currentUser;
            showScreen('homeScreen');
        } else {
            showScreen('loginScreen');
        }
        loadDrivers();
    };

    // ---------- ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ----------
    function showScreen(screenId) {
        document.getElementById('loginScreen').classList.add('hidden');
        document.getElementById('homeScreen').classList.add('hidden');
        document.getElementById('driverRegScreen').classList.add('hidden');
        document.getElementById('customerPanel').classList.add('hidden');
        document.getElementById('bookingScreen').classList.add('hidden');
        document.getElementById('successScreen').classList.add('hidden');
        document.getElementById('historyScreen').classList.add('hidden');
        document.getElementById(screenId).classList.remove('hidden');
    }

    // ---------- ‡§≤‡•â‡§ó‡§ø‡§® (‡§¨‡§ø‡§®‡§æ OTP) ----------
    window.login = function() {
        let mobile = document.getElementById('mobileInput').value.trim();
        if (mobile.length !== 10 || isNaN(mobile)) {
            alert('‚úÖ 10 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡§ø‡§è');
            return;
        }
        currentUser = mobile;
        localStorage.setItem('truckUser', mobile);
        document.getElementById('userPhoneDisplay').innerText = mobile;
        showScreen('homeScreen');
    };

    // ---------- ‡§π‡•ã‡§Æ ‡§∏‡•á ‡§µ‡§æ‡§™‡§∏ ----------
    window.backToHome = function() { showScreen('homeScreen'); };
    window.backToCustomerPanel = function() { showScreen('customerPanel'); };

    // ---------- ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ----------
    window.showDriverReg = function() {
        showScreen('driverRegScreen');
    };

    // ---------- ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§∏‡•á‡§µ (‡§≤‡•ã‡§ï‡§≤ ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú) ----------
    // ---------- ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§∏‡•á‡§µ (FIREBASE) ----------
window.registerDriver = async function() {
    // 1. ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§Ø‡•Ç‡§ú‡§∞ ‡§≤‡•â‡§ó‡§ø‡§® ‡§π‡•à ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç
    const user = firebase.auth().currentUser;
    if (!user) {
        alert('‡§™‡§π‡§≤‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•ã!');
        showScreen('loginScreen');
        return;
    }
    
    // 2. ‡§´‡•â‡§∞‡•ç‡§Æ ‡§∏‡•á ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≤‡•ã
    let name = document.getElementById('driverName').value;
    let vehicle = document.getElementById('driverVehicle').value;
    let type = document.getElementById('driverTruckType').value;
    let labour = document.getElementById('driverLabour').value;
    
    // 3. ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∏‡§¨ ‡§≠‡§∞‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç
    if (!name || !vehicle || !labour) {
        alert('‡§∏‡§æ‡§∞‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡§∞‡•ã ‡§≠‡§æ‡§à!');
        return;
    }
    
    labourCount = parseInt(labour) || 2;
    
    try {
        // 4. ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•ã
        const driverData = {
            name: name,
            vehicle: vehicle,
            truckType: type,
            labour: labourCount,
            phone: user.phoneNumber || currentUser, // ‡§´‡§º‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞
            userId: user.uid,
            registeredAt: new Date().toISOString(),
            totalBookings: 0,
            rating: 0,
            isAvailable: true
        };
        
        // 5. FIREBASE (Database) ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞‡•ã
        const docRef = await db.collection('drivers').add(driverData);
        
        alert(`üöõ ${name} ‡§ú‡•Ä, ‡§Ü‡§™ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§π‡•ã ‡§ó‡§è! ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ID: ${docRef.id}`);
        showScreen('homeScreen');
        
    } catch (error) {
        console.error('Error:', error);
        alert('‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§ó‡§°‡§º‡§¨‡§°‡§º‡•Ä: ' + error.message);
    }
};
    

    // ---------- ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§≤‡•ã‡§° (‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§Ø‡•Ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á) ----------
    function loadDrivers() {
        drivers = JSON.parse(localStorage.getItem('truckDrivers')) || [];
    }

    // ---------- ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§™‡•à‡§®‡§≤ ----------
    window.showCustomerPanel = function() {
        showScreen('customerPanel');
    };

    // ---------- ‡§ó‡§æ‡§°‡§º‡•Ä ‡§ö‡•Å‡§®‡•ã ----------
    window.selectTruck = function(truck, base) {
        selectedTruck = truck;
        basePrice = base;
        document.getElementById('selectedTruckDisplay').innerHTML = 'üöõ ‡§ó‡§æ‡§°‡§º‡•Ä: <b>' + truck + '</b>';
        // ‡§Æ‡§ú‡§¶‡•Ç‡§∞ ‡§¶‡§ø‡§ñ‡§æ‡§ì (‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§Ø‡§æ ‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§ï‡•á ‡§π‡§ø‡§∏‡§æ‡§¨ ‡§∏‡•á)
        document.getElementById('labourDisplay').innerHTML = 'üë∑ ‡§á‡§∏ ‡§ó‡§æ‡§°‡§º‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• <b>' + labourCount + ' ‡§Æ‡§ú‡§¶‡•Ç‡§∞</b> ‡§Ü‡§è‡§Å‡§ó‡•á‡•§';
        showScreen('bookingScreen');
        document.getElementById('kmInput').value = '';
        document.getElementById('fareDisplay').innerHTML = '‡§ï‡•Å‡§≤ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ: ‚Çπ0';
        document.getElementById('commissionDisplay').innerHTML = 'üü¢ 15% ‡§ê‡§™ ‡§ï‡§Æ‡•Ä‡§∂‡§®: ‚Çπ0';
    };

    // ---------- ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü + 15% ‡§ï‡§Æ‡•Ä‡§∂‡§® ----------
    window.calculateFare = function() {
        let km = parseFloat(document.getElementById('kmInput').value) || 0;
        if (selectedTruck === '‡§õ‡•ã‡§ü‡§æ ‡§π‡§æ‡§•‡•Ä') {
            if (km <= 10) finalFare = 500;
            else if (km <= 20) finalFare = 1000;
            else finalFare = km * 50;
        } else {
            finalFare = basePrice + (km * 40);
        }
        commission = Math.round(finalFare * 0.15);
        document.getElementById('fareDisplay').innerHTML = 'üí∞ ‡§ï‡•Å‡§≤ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ: ‚Çπ' + finalFare;
        document.getElementById('commissionDisplay').innerHTML = 'üü¢ 15% ‡§ê‡§™ ‡§ï‡§Æ‡•Ä‡§∂‡§®: ‚Çπ' + commission + ' (‡§π‡§Æ‡§æ‡§∞‡§æ ‡§π‡§ø‡§∏‡•ç‡§∏‡§æ)';
    };

    // ---------- ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§®‡•ç‡§´‡§∞‡•ç‡§Æ (‡§≤‡•ã‡§ï‡§≤ ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú) ----------
    window.confirmBooking = function() {
        if (finalFare <= 0) {
            alert('‡§™‡§π‡§≤‡•á ‡§¶‡•Ç‡§∞‡•Ä ‡§°‡§æ‡§≤‡•ã!');
            return;
        }
        let km = parseFloat(document.getElementById('kmInput').value) || 0;
        let bookingId = 'TKE' + Math.floor(1000 + Math.random() * 9000);
        let booking = {
            id: bookingId,
            user: currentUser,
            truck: selectedTruck,
            km: km,
            fare: finalFare,
            commission: commission,
            labour: labourCount,
            time: new Date().toLocaleString()
        };
        let history = JSON.parse(localStorage.getItem('truckHistory')) || [];
        history.unshift(booking);
        localStorage.setItem('truckHistory', JSON.stringify(history));

        // ‡§¨‡§ø‡§≤ ‡§¶‡§ø‡§ñ‡§æ‡§ì
        let bill = `
            <b>‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ID:</b> ${bookingId}<br>
            <b>‡§ó‡§æ‡§°‡§º‡•Ä:</b> ${selectedTruck}<br>
            <b>‡§¶‡•Ç‡§∞‡•Ä:</b> ${km} km<br>
            <b>‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ:</b> ‚Çπ${finalFare}<br>
            <b>‡§π‡§Æ‡§æ‡§∞‡§æ ‡§ï‡§Æ‡•Ä‡§∂‡§® (15%):</b> ‚Çπ${commission}<br>
            <b>‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§ï‡•ã:</b> ‚Çπ${finalFare - commission}<br>
            <b>‡§Æ‡§ú‡§¶‡•Ç‡§∞:</b> ${labourCount}<br>
            <b>‡§∏‡§Æ‡§Ø:</b> ${booking.time}
        `;
        document.getElementById('billDetails').innerHTML = bill;
        showScreen('successScreen');
    };

    // ---------- ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç ----------
    window.showHistory = function() {
        let history = JSON.parse(localStorage.getItem('truckHistory')) || [];
        let listDiv = document.getElementById('historyList');
        if (history.length === 0) {
            listDiv.innerHTML = '<p style="color:gray;">‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§à‡•§</p>';
        } else {
            let html = '';
            history.forEach(b => {
                html += `<div class="history-item">
                    <b>üÜî ${b.id}</b><br>
                    üöõ ${b.truck} | ‚Çπ${b.fare}<br>
                    üìè ${b.km} km | üë∑ ${b.labour} ‡§Æ‡§ú‡§¶‡•Ç‡§∞<br>
                    <small>üìÖ ${b.time}</small>
                </div>`;
            });
            listDiv.innerHTML = html;
        }
        showScreen('historyScreen');
    };

</script>
     <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js"></script>
    
<script>
  // ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyByh4tT4zcUpjjQ_ebaYzpSulGtsDHjbw0",
    authDomain: "truckease-cb961.firebaseapp.com",
    projectId: "truckease-cb961",
    storageBucket: "truckease-cb961.firebasestorage.app",
    messagingSenderId: "558046020925",
    appId: "1:558046020925:web:573533af4bbf93841e3154"
  };

  // Firebase ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•ã
  if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
  }
  const auth = firebase.auth();
  const db = firebase.firestore();

  // ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§¨‡§®‡§æ‡§ì ‡§§‡§æ‡§ï‡§ø ‡§Ö‡§ó‡§≤‡•á ‡§∏‡•ç‡§ü‡•á‡§™ ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§Æ ‡§Ü‡§è
  window.auth = auth;
  window.db = db;
  console.log("‚úÖ Firebase ‡§Ö‡§¨ ‡§è‡§ï‡§¶‡§Æ ‡§∏‡§π‡•Ä ‡§ú‡§ó‡§π ‡§™‡§∞ ‡§π‡•à!");
</script>
</body>
</html>
