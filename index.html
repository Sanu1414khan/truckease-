<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TruckEase - Professional Truck Booking</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a73e8;
            --secondary-color: #34a853;
            --dark-color: #202124;
            --light-color: #f8f9fa;
            --gray-color: #dadce0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
        }
        body { font-family: 'Noto Sans Devanagari', sans-serif; margin: 0; background: #fff; color: var(--dark-color); }
        .container { max-width: 400px; margin: 0 auto; background: white; min-height: 100vh; display: flex; flex-direction: column; }
        header { background: var(--primary-color); color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; }
        .screen { display: none; padding: 20px; flex-grow: 1; }
        .active { display: flex; flex-direction: column; }
        input, button, select { width: 100%; padding: 14px; margin: 10px 0; border: 1px solid var(--gray-color); border-radius: var(--border-radius); font-size: 16px; box-sizing: border-box; }
        button { background: var(--primary-color); color: white; border: none; cursor: pointer; font-weight: 600; transition: 0.3s; }
        
        /* फोटो वाला नया डिज़ाइन */
        .v-header { margin-top: 30px; }
        .v-header h1 { font-size: 24px; font-weight: 500; margin-bottom: 10px; }
        .v-header p { color: #70757a; font-size: 14px; line-height: 1.5; }
        .phone-box { display: flex; align-items: center; border-bottom: 2px solid var(--primary-color); padding: 10px 0; margin-top: 40px; }
        .phone-box img { width: 25px; margin-right: 10px; }
        .phone-box span { font-size: 18px; margin-right: 10px; }
        .phone-box input { border: none; font-size: 18px; padding: 0; margin: 0; width: 100%; outline: none; }
        .next-btn { background: #ccc; margin-top: auto; margin-bottom: 20px; border-radius: 8px; }
        .next-btn.active-btn { background: var(--primary-color); }

        .secondary-btn { background: var(--light-color); color: var(--dark-color); border: 1px solid var(--gray-color); }
        .back-btn { width: auto; background: transparent; color: var(--primary-color); padding: 5px; font-weight: bold; }
        .truck-card { border: 1px solid var(--gray-color); padding: 15px; border-radius: var(--border-radius); margin-bottom: 12px; display: flex; align-items: center; gap: 15px; background: #fff; cursor: pointer; }
        .price-display { background: #e8f5e9; padding: 15px; text-align: center; border-radius: 10px; font-weight: bold; margin: 10px 0; border-left: 5px solid var(--secondary-color); }
        footer { background: var(--dark-color); color: white; padding: 15px; text-align: center; font-size: 12px; margin-top: auto; }
        .rtl { direction: rtl; text-align: right; }
    </style>
</head>
<body>

<div class="container">
    <div id="login-screen" class="screen active">
        <div class="v-header">
            <h1>Enter Phone number for verification</h1>
            <p>This number will be used for all ride-related communication. You shall receive an SMS with code for verification.</p>
        </div>
        <div class="phone-box">
            <img src="https://upload.wikimedia.org/wikipedia/en/4/41/Flag_of_India.svg">
            <span>+91 <i class="fas fa-caret-down" style="font-size: 12px;"></i></span>
            <input type="tel" id="mob" placeholder="Your number" oninput="validatePhone()">
        </div>
        <div id="recaptcha-container"></div>
        <button id="l-btn" class="next-btn" onclick="sendOTP()" disabled>Next</button>
    </div>

    <div id="user-type-screen" class="screen">
        <header>
            <h1 style="font-size: 20px; margin: 0;"><i class="fas fa-truck-moving"></i> TruckEase</h1>
        </header>
        <h2 id="ut-title">आप कौन हैं?</h2>
        <button id="btn-cust" onclick="nav('home-screen')"><i class="fas fa-user"></i> ग्राहक (Customer)</button>
        <button id="btn-dri" onclick="nav('driver-reg-screen')"><i class="fas fa-id-card"></i> ड्राइवर पंजीकरण (Register)</button>
        <button class="secondary-btn" id="btn-hist" onclick="nav('history-screen')"><i class="fas fa-history"></i> बुकिंग इतिहास</button>
    </div>

    <div id="driver-reg-screen" class="screen">
        <button class="back-btn" onclick="nav('user-type-screen')">← वापस</button>
        <h2>ड्राइवर रजिस्ट्रेशन</h2>
        <input type="text" id="dri-name" placeholder="पूरा नाम">
        <input type="tel" id="dri-phone" placeholder="मोबाइल नंबर">
        <input type="text" placeholder="ID नंबर (आधार/लाइसेंस)">
        <select id="dri-truck-type">
            <option value="छोटा हाथी">छोटा हाथी (Small Pickup)</option>
            <option value="मझोला ट्रक">मझोला ट्रक (Medium Truck)</option>
            <option value="भारी ट्रक">भारी ट्रक (Heavy Truck)</option>
        </select>
        <input type="text" placeholder="गाड़ी का नंबर">
        <input type="number" id="dri-labour" placeholder="मजदूरों की संख्या (जैसे: 2)">
        <input type="file" accept="image/*">
        <button onclick="registerDriver()">सफलतापूर्वक रजिस्टर करें</button>
    </div>

    <div id="home-screen" class="screen">
        <button class="back-btn" onclick="nav('user-type-screen')">← वापस</button>
        <h3 id="h-title">अपनी गाड़ी चुनें</h3>
        <div class="truck-card" onclick="pickTruck('छोटा हाथी', 0)"><i class="fas fa-truck-pickup"></i> <div><b>छोटा हाथी</b><br><small>10KM: ₹500 | 20KM: ₹1000</small></div></div>
        <div class="truck-card" onclick="pickTruck('मझोला ट्रक', 1200)"><i class="fas fa-truck"></i> <div><b>मझोला ट्रक</b><br><small>लंबी दूरी के लिए</small></div></div>
        <div class="truck-card" onclick="pickTruck('भारी ट्रक', 2500)"><i class="fas fa-shipping-fast"></i> <div><b>भारी ट्रक</b><br><small>इंडस्ट्रियल लोड</small></div></div>
    </div>

    <div id="booking-screen" class="screen">
        <button class="back-btn" onclick="nav('home-screen')">← वापस</button>
        <h3 id="b-title">बुकिंग जानकारी</h3>
        <p id="selected-truck-info"></p>
        <p id="labour-info" style="font-size: 14px; background: #eee; padding: 10px; border-radius: 8px;"></p>
        <input type="number" id="dist" placeholder="कितने KM जाना है?" oninput="calcFare()">
        <div id="price-box" class="price-display">कुल किराया: ₹0</div>
        <button id="b-confirm" onclick="confirmBooking()">कन्फर्म करें</button>
    </div>

    <div id="success-screen" class="screen" style="text-align: center;">
        <i class="fas fa-check-circle" style="font-size: 60px; color: var(--secondary-color);"></i>
        <h2 id="s-msg">बुकिंग सफल!</h2>
        <div id="bill" style="text-align: left; background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #ddd; margin: 20px 0;"></div>
        <button onclick="nav('user-type-screen')">मुख्य मेनू</button>
    </div>

    <div id="history-screen" class="screen">
        <button class="back-btn" onclick="nav('user-type-screen')">← वापस</button>
        <h2 id="hist-title">पुरानी बुकिंग</h2>
        <div id="history-list"></div>
    </div>

    <footer>© 2026 TruckEase</footer>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getAuth, RecaptchaVerifier, signInWithPhoneNumber } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyByh4tT4zcUpjjQ_ebaYzpSulGtsDHjbw0",
    authDomain: "truckease-cb961.firebaseapp.com",
    projectId: "truckease-cb961",
    storageBucket: "truckease-cb961.firebasestorage.app",
    messagingSenderId: "558046020925",
    appId: "1:558046020925:web:573533af4bbf93841e3154"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  window.validatePhone = function() {
      const input = document.getElementById('mob');
      const btn = document.getElementById('l-btn');
      if(input.value.length === 10) {
          btn.disabled = false;
          btn.classList.add('active-btn');
      } else {
          btn.disabled = true;
          btn.classList.remove('active-btn');
      }
  }

  window.sendOTP = function() {
      const number = "+91" + document.getElementById('mob').value;
      window.recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', { 'size': 'invisible' });
      signInWithPhoneNumber(auth, number, window.recaptchaVerifier)
          .then((confirmationResult) => {
              window.confirmationResult = confirmationResult;
              let code = prompt("Enter 6-digit OTP:");
              if (code) {
                  confirmationResult.confirm(code).then(() => { nav('user-type-screen'); })
                  .catch(() => { alert("गलत OTP!"); });
              }
          }).catch((error) => { alert(error.message); });
  }

  window.nav = function(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
  }
</script>

<script>
    // बाकी के सारे फंक्शन्स (pickTruck, calcFare, confirmBooking, registerDriver) यहाँ हैं...
    let selTruck = ""; let baseP = 0; let finalP = 0;
    let currentLabourCount = 2;

    function pickTruck(n, p) { 
        selTruck = n; baseP = p; 
        document.getElementById('selected-truck-info').innerText = "चुनी गई गाड़ी: " + n;
        document.getElementById('labour-info').innerHTML = `<i class="fas fa-users"></i> इस गाड़ी के साथ <b>${currentLabourCount} मजदूर</b> आयेंगे।`;
        nav('booking-screen'); 
    }

    function calcFare() {
        let k = parseFloat(document.getElementById('dist').value) || 0;
        if (selTruck === 'छोटा हाथी') {
            if (k > 0 && k <= 10) finalP = 500;
            else if (k > 10 && k <= 20) finalP = 1000;
            else if (k > 20) finalP = k * 50;
            else finalP = 0;
        } else {
            finalP = baseP + (k * 40);
        }
        document.getElementById('price-box').innerText = "कुल किराया: ₹" + finalP;
    }

    function confirmBooking() {
        if (finalP <= 0) { alert("कृपया दूरी सही से डालें!"); return; }
        let bId = "TKE" + Math.floor(1000 + Math.random() * 9000);
        let data = { id: bId, truck: selTruck, fare: finalP, labour: currentLabourCount, date: new Date().toLocaleString() };
        let history = JSON.parse(localStorage.getItem('truckHistory')) || [];
        history.unshift(data);
        localStorage.setItem('truckHistory', JSON.stringify(history));
        document.getElementById('bill').innerHTML = `<b>बुकिंग ID:</b> ${bId}<br><b>गाड़ी:</b> ${selTruck}<br><b>किराया:</b> ₹${finalP}`;
        nav('success-screen');
    }

    function registerDriver() {
        let name = document.getElementById('dri-name').value;
        currentLabourCount = document.getElementById('dri-labour').value;
        alert(`बधाई हो ${name}! रजिस्टर हो गया।`);
        nav('user-type-screen');
    }
</script>
</body>
</html>
